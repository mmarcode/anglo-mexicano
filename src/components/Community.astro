---
const images = Array.from({ length: 16 }, (_, i) => `/images/home/${i + 1}.webp`);
---
<svg 
  xmlns="http://www.w3.org/2000/svg"
  xmlns:xlink="http://www.w3.org/1999/xlink"
  version="1.1"
  x="0px"
  y="0px"
  viewBox="0 0 1920 90"
  style="enable-background:new 0 0 1920 90;"
  xml:space="preserve"
>
  <polygon fill="#2E7ECF" points="0,89 1920,-1 0,-1  "/>
  <polygon fill="#4a90e2" points="0,0 960,45 0,90  "/>
</svg>

<section class="max-w-7xl mx-auto px-6 py-20">
  <h2 class="text-4xl md:text-5xl font-bold text-center text-[#505050]">
    Nuestra Comunidad Educativa
  </h2>
  <p class="mt-4 text-center text-lg md:text-xl text-gray-600 leading-relaxed max-w-4xl mx-auto mb-12">
    Un espacio donde alumnos, familias y docentes crecen juntos cada día.
  </p>

  <!-- Grid -->
  <div class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-4 gap-6">
    {images.map((src, index) => (
      <button
        class="group relative overflow-hidden rounded-xl shadow-md focus:outline-none"
        data-index={index}
        aria-label="Ver imagen ampliada"
      >
        <img
          src={src}
          alt="Galería escolar"
          width="800"
          height="600"
          class="w-full h-56 object-cover transition-transform duration-500 group-hover:scale-110"
          loading="lazy"
        />
        <div class="absolute inset-0 bg-black/0 group-hover:bg-black/20 transition"></div>
      </button>
    ))}
  </div>

  <!-- Lightbox -->
  <div id="lightbox" class="fixed inset-0 z-50 hidden bg-black/80 backdrop-blur-sm" role="dialog" aria-modal="true" aria-label="Galería ampliada">
    <button id="close" class="absolute top-6 right-6 text-white text-3xl" aria-label="Cerrar imagen">×</button>
    <img id="lightbox-img" class="max-w-[90%] max-h-[90%] mx-auto mt-20 rounded-lg shadow-xl" alt="Galería escolar" />
    <button id="prev" class="absolute left-6 top-1/2 text-white text-4xl" aria-label="Anterior">‹</button>
    <button id="next" class="absolute right-6 top-1/2 text-white text-4xl" aria-label="Siguiente">›</button>
  </div>
</section>

<script>
  const buttons = document.querySelectorAll('[data-index]');
  const lightbox = document.getElementById('lightbox');
  const img = document.getElementById('lightbox-img');
  const close = document.getElementById('close');
  const prev = document.getElementById('prev');
  const next = document.getElementById('next');

  let current = 0;
  const images = [...buttons].map(b => b.querySelector('img').src);

  function open(index) {
    current = index;
    img.src = images[current];
    img.alt = `Galería escolar imagen ${current + 1}`;
    lightbox.classList.remove('hidden');
    // focus close for accessibility
    close && close.focus();
  }

  buttons.forEach((btn, i) => btn.addEventListener('click', () => open(i)));

  close.onclick = () => lightbox.classList.add('hidden');
  prev.onclick = () => open((current - 1 + images.length) % images.length);
  next.onclick = () => open((current + 1) % images.length);
  document.addEventListener('keydown', e => e.key === 'Escape' && close.onclick());
</script>
